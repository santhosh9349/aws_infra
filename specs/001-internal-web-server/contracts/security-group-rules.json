{
  "security_group": {
    "name": "internal-web-server-sg",
    "description": "Security group for internal web server - HTTPS only from internal VPCs",
    "ingress_rules": [
      {
        "description": "HTTPS from Inspection VPC",
        "protocol": "tcp",
        "from_port": 443,
        "to_port": 443,
        "cidr_blocks": ["192.0.0.0/16"],
        "ipv6_cidr_blocks": [],
        "prefix_list_ids": [],
        "security_groups": [],
        "self": false
      },
      {
        "description": "HTTPS from Dev VPC (intra-VPC communication)",
        "protocol": "tcp",
        "from_port": 443,
        "to_port": 443,
        "cidr_blocks": ["172.0.0.0/16"],
        "ipv6_cidr_blocks": [],
        "prefix_list_ids": [],
        "security_groups": [],
        "self": false
      },
      {
        "description": "HTTPS from Prod VPC",
        "protocol": "tcp",
        "from_port": 443,
        "to_port": 443,
        "cidr_blocks": ["10.0.0.0/16"],
        "ipv6_cidr_blocks": [],
        "prefix_list_ids": [],
        "security_groups": [],
        "self": false
      }
    ],
    "egress_rules": [
      {
        "description": "All outbound traffic (OS updates, SSM endpoints)",
        "protocol": "-1",
        "from_port": 0,
        "to_port": 0,
        "cidr_blocks": ["0.0.0.0/0"],
        "ipv6_cidr_blocks": [],
        "prefix_list_ids": [],
        "security_groups": [],
        "self": false
      }
    ],
    "tags": {
      "Name": "internal-web-server-sg",
      "Environment": "dev",
      "Project": "AWS Infrastructure",
      "ManagedBy": "Terraform",
      "Owner": "DevOps Team",
      "CostCenter": "dev",
      "VPC": "dev"
    }
  },
  "validation_rules": {
    "prohibited_ingress_ports": [22, 80, 3389],
    "prohibited_ingress_cidrs": ["0.0.0.0/0"],
    "required_ingress_ports": [443],
    "required_protocols": ["tcp"]
  }
}
